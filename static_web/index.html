<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<!--
Design by TEMPLATED
http://templated.co
Released for free under the Creative Commons Attribution License

Name       : SimpleDisplay
Description: A two-column, fixed-width design with dark color scheme.
Version    : 1.0
Released   : 20120611
-->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<meta name="keywords" content="monoplasma revenue sharing ethereum token sidechain demo" />
	<meta name="description" content="See https://github.com/streamr-dev/monoplasma" />
	<meta http-equiv="content-type" content="text/html; charset=utf-8" />
	<title>Revenue sharing demo</title>
	<link href="res/font.css" rel="stylesheet" type="text/css" />
	<link href="res/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
	<link href="res/template-style.css" rel="stylesheet" type="text/css" media="screen" />
	<link href="res/style.css" rel="stylesheet" type="text/css" media="screen" />
	<!--<script src="js/web3.min.js"></script>-->
	<script type="text/javascript" src="js/abi.js"></script>
	<script type="text/javascript" src="res/ethjs.min.js"></script>
</head>
<body>
<div id="wrapper">
	<div id="header">
		<div id="logo">
			<h1><a href="#">Revenue sharing demo</a></h1>
		</div>
	</div>
	<div class="one-column" id="no-accounts" hidden>
		<p class="warning-text">You need to log in with your Metamask. Please click it open from your browser bar.</p>
	</div>
	<div class="one-column" id="no-metamask" hidden>
		<p class="warning-text">No Metamask detected. Please install <a href="https://metamask.io/">Metamask browser plugin</a></p>
	</div>

	<div class="two-columns">
		<div id="col1">
			<h2>User account</h2>
			<input id="address-selection-input" type="text" class="text-input" placeholder="0x0000000000000000000000000000000000000000">
			<button id="address-selection-button" onclick="onClickSelect()" class="btn btn-lg btn-success" type="button">Select</button>
			<div id="earnings">
				<p id="selected-account-label">Please select an account</p>
				<table>
					<tr><td>Total earnings:</td><td><span class="member-total-earnings-label">0</span><span class="token-symbol"></span></td></tr>
					<tr><td>Total earnings recorded:</td><td><span class="member-total-recorded-label">0</span><span class="token-symbol"></span></td></tr>
					<tr><td>Total withdrawn:</td><td><span id="member-withdrawn-label">0</span><span class="token-symbol"></span></td></tr>
					<tr><td>Earnings still frozen:</td><td><span class="member-frozen-label">0</span><span class="token-symbol"></span></td></tr>
					<tr><td>Earnings withdrawable:</td><td><span class="member-withdrawable-label">0</span><span class="token-symbol"></span></td></tr>
				</table>
			</div>
			<div id="withdraw">
				<button onclick="onClickWithdraw()" class="btn btn-lg btn-success">Withdraw</button>
				<p>Sends the latest unfrozen proof of earnings to the Monoplasma root chain contract, and asks it to send back the appropriate amount of tokens.</p>
			</div>
		</div>
		<div id="col2">
			<h2>Community</h2>
			<table>
				<tr><td>Member count:</td><td><span id="member-count-label">0</span></td></tr>
				<tr><td>Total earnings:</td><td><span class="total-earnings-label">0</span><span class="token-symbol"></span></td></tr>
				<tr><td>Total earnings recorded:</td><td><span class="total-recorded-label">0</span><span class="token-symbol"></span></td></tr>
				<tr><td>Total withdrawn:</td><td><span id="withdrawn-label">0</span><span class="token-symbol"></span></td></tr>
				<tr><td>Contract balance:</td><td><span class="contract-balance-label">0</span><span class="token-symbol"></span></td></tr>
				<tr><td>Earnings still frozen:</td><td><span class="frozen-label">0</span><span class="token-symbol"></span></td></tr>
				<tr><td>Earnings withdrawable:</td><td><span class="withdrawable-label">0</span><span class="token-symbol"></span></td></tr>
			</table>
			<br>
			<button onclick="onClickAddRevenue()" class="btn btn-lg btn-success">Add revenue</button>
			<p>Send some tokens to the Monoplasma contract</p>
		</div>
	</div>
	<div class="three-columns">
		<div id="column1">
			<h2>Administrator</h2>
			<textarea id="address-list" rows=6 placeholder="Ethereum addresses here, one per line" class="text-input"></textarea>
			<button onclick="onClickAddUsers()" class="btn btn-lg btn-warning">Add users</button>
			<p>Adds the addresses above to the revenue sharing pool. These users will then receive revenue shares from tokens that are transferred to the root-chain contract.</p>
			<button onclick="onClickKick()" class="btn btn-lg btn-warning">Kick user out</button>
			<p>De-activates the currently selected user <span class="selected-user-name"></span>. This user will not receive revenue share from income while de-activated.</p>
		</div>
		<div id="column2">
			<h2>Operator</h2>
			<div id="force-publish" class="countdown-button">
				<svg class="countdown">
					<circle class="countdown-circle" r="60" cx="70" cy="70"></circle>
				</svg>
				<button onclick="onClickForcePublish()" class="round-button">Force publish</button>
			</div>
			<p>
				Normally the Operator publishes side-chain blocks when the first revenue transaction arrives after a cooldown period.
				This cooldown period plus the block freeze period is the time it takes for a member to be able to withdraw
					tokens after the token transaction where it earned them.
				The point of the cooldown period is to not unnecessarily pay for block publishing if revenue arrives rapidly.
				All tokens earned during this period are in the hands of the operator (similarly to tokens in an exchange).
				The member can lose only those tokens in case of total breakdown of the operator.
				By pressing the "Force publish" button, you can ask the operator to publish a block even during the
					cooldown period, or if no revenue has been added.
			</p>
		</div>
		<div id="column3">
			<h2>Demo features</h2>
			<div class="metamask-is-working" hidden>
				<p>Metamask address: <span id="metamask-address"></span></p>
				<p>Metamask wallet balance: <span id="metamask-token-balance">0</span><span class="token-symbol"></span></p>
				<button onclick="onClickMint()" class="btn btn-lg btn-success">Mint tokens</button>
				<p>Mints new tokens and deposits them to the currently selected account in Metamask</p>
			</div>
			<button onclick="onClickSteal()" class="btn btn-lg btn-danger">Steal all tokens</button>
			<p>Operator can try to publish a block where all tokens have been allocated to it</p>
		</div>
	</div>
	<div class="one-column">
		<h2 class="title"><a href="#">What does it do</a></h2>
		<div class="entry">
			<p>
				This is <strong>Monoplasma revenue sharing demo</strong>, demonstration of how the Monoplasma
				contracts can be used to implement a rudimentary ERC20-token revenue sharing facility.

				There are several roles in the system:
				<ul>
					<li><strong>Operator</strong> who owns the root chain contract and publishes side-chain blocks</li>
					<li><strong>Validator</strong> who also runs a side-chain and checks the published blocks</li>
					<li><string>Member</string> of the revenue sharing community who has the primary interest in ensuring the operator is honest</li>
				</ul>
			</p>
		</div>
	</div>
</div>
<div id="footer">
	<p>Design by <a href="https://templated.co/simpledisplay" rel="nofollow">TEMPLATED</a>, licenced under <a href="http://creativecommons.org/licenses/by/3.0/">CC-BY 3.0</a>.</p>
</div>
<script src="js/revenue-sharing-demo-ui.js"></script>
</body>
</html>
